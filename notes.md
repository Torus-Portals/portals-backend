

https://cetra3.github.io/blog/face-detection-with-actix-web/

## Futures

```
TL;DR: then is used when you want to do something regardless of if the future was successful or not, and_then runs the closure only when the future succeeded, and or_else runs the closure only when the future failed.
```

https://docs.rs/future-by-example/0.1.0/future_by_example/

fut_ok wraps things in a future.

## Debugging

```
// print out actual query that is generated by diesel:
use diesel::debug_query;

println!("{}", debug_query::<diesel::pg::Pg, _>(&query));
```

## Dealing with JWTs

#### Helpful links
1. You can find the Auth0 certificate for the cert.crt file here: https://torus-rocks.auth0.com/.well-known/jwks.json. The cert is the first entry under "x5c"
2. https://github.com/Keats/jsonwebtoken/issues/62: tells you the commands to go from the cert.crt to an rsa .der
3. https://support.ssl.com/Knowledgebase/Article/View/19/0/der-vs-crt-vs-cer-vs-pem-certificates-and-how-to-convert-them: some good info on certs/pem/der

```
// check out x5c cert:
openssl x509 -in certificate.crt -text -noout

// convert cert.crt from x5c to auth0.der file needed:
openssl x509 -pubkey -noout -in  auth0.pem  > auth0_pkey.pem
openssl rsa -pubin -in auth0_pkey.pem  -RSAPublicKey_out -outform DER -out auth0.der
```

Don't forget to wrap cet from x5c with: 
```
-----BEGIN CERTIFICATE-----
    ...cert goes here...
-----END CERTIFICATE-----
```

## Diesel

```
$ diesel migration redo
$ diesel migration run
$ diesel migration generate name_of_migration
```

### Handling JSON and JSONB
https://github.com/diesel-rs/diesel/issues/1950

### Dealing with a "error: EADDRINUSE: Address already in use"

https://stackoverflow.com/questions/3855127/find-and-kill-process-locking-port-3000-on-mac

```
$ sudo lsof -i :8088
// or
$ sudo lsof -i tcp:8088
```


## Postgres

Some helpful debugging stuff: https://postgresapp.com/documentation/troubleshooting.html

### Postgres in Docker.

#### Creating a new Docker Postgres instance.

```
# docker run --name torus_db -e POSTGRES_USER=brochstilley -e POSTGRES_PASSWORD=Hellothere123! -d -p 5432:5432 postgres
```

```
// psql help (while in psql)
postgres=# \l  // list databases
postgres=# \du // list users and roles
```

```
-- Might need to run drop table commands separate for each table.
-- DROP TABLE __diesel_schema_migrations, orgs, portals, users, portalviews, blocks, dimensions, cells;
-- DROP EXTENSION pgcrypto;
```

## Just...some good articles
http://bryce.fisher-fleig.org/blog/strategies-for-returning-references-in-rust/index.html


## Local DB in aws
DATABASE_URL=postgres://postgres:qwerty123456!@portals-local-1.cece4u7qvrsx.us-west-1.rds.amazonaws.com:5432/portals_main